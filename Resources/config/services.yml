parameters:
    sonata.media.thumbnail.liip_imagine: Gotoemma\MediaApiBundle\Thumbnail\LiipImagineThumbnail
    gotoemma_imagine.controller.class: Gotoemma\MediaApiBundle\Controller\ImagineController

services:
    Sonata\CoreBundle\Model\ManagerInterface: '@sonata.media.manager.media'

    Gotoemma\MediaApiBundle\EventListener\PostLoadEventListener:
        class: Gotoemma\MediaApiBundle\EventListener\PostLoadEventListener
        arguments:
            - '@service_container'
            - '@request_stack'
        tags:
            - { name: 'doctrine.event_listener', event: 'postLoad'}

    sonata.media.provider.sproutvideo:
        class: Gotoemma\MediaApiBundle\Provider\SproutVideoProvider
        tags:
            - { name: 'sonata.media.provider' }
        arguments:
            - 'sonata.media.provider.sproutvideo'
            - '@sonata.media.filesystem.local'
            - '@sonata.media.cdn.server'
            - '@sonata.media.generator.default'
            - '@sonata.media.thumbnail.format'
            - '@sonata.media.buzz.browser'
            - '@sonata.media.metadata.proxy'
        calls:
            -  [ setTemplates, [ { helper_thumbnail: MediaApiBundle:Provider:thumbnail.html.twig, helper_view: MediaApiBundle:Provider:view_sproutvideo.html.twig } ] ]

    sonata.media.provider.pdf:
        class: Gotoemma\MediaApiBundle\Provider\PdfProvider
        tags:
            - { name: 'sonata.media.provider' }
        arguments: ['','','','','','','','','@sonata.media.metadata.proxy','@service_container']
        calls:
            -  [ setTemplates, [ { helper_thumbnail: MediaApiBundle:Provider:thumbnail.html.twig, helper_view: MediaApiBundle:Provider:view_pdf.html.twig } ] ]

    media_api.file.validator:
        class: Gotoemma\MediaApiBundle\Validator\Constraints\FileValidator
        arguments:
            - '@service_container'
        tags:
            - { name: validator.constraint_validator, alias: media_api.file.validator }

    gotoemma_imagine.controller:
        class: '%gotoemma_imagine.controller.class%'
        arguments:
            - '@liip_imagine.data.manager'
            - '@liip_imagine.filter.manager'
            - '@liip_imagine.cache.manager'
            - '@liip_imagine.cache.signer'
            - '@service_container'